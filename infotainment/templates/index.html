<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lounaslista</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <!-- Glide.js CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/css/glide.core.min.css">

    <script defer src="https://cdn.jsdelivr.net/npm/@glidejs/glide"></script>
</head>
<body>
    <h1>Päivän lounas</h1>

    <!-- Glide.js Slider -->
    <div class="glide">
        <div class="glide__track" data-glide-el="track">
            <ul class="glide__slides" id="menu"></ul>
        </div>
    </div>

    <div class="glide" id="web-slider">
        <div class="glide__track" data-glide-el="track">
            <ul class="glide__slides">
                <li class="glide__slide"><iframe src="https://www.google.com" frameborder="0"></iframe></li>
                <li class="glide__slide"><iframe src="https://www.eficode.com" frameborder="0"></iframe></li>
                <li class="glide__slide"><iframe src="https://www.foreca.com" frameborder="0"></iframe></li>
            </ul>
        </div>
    </div>

    <script>
        async function fetchLunchData() {
            const response = await fetch('/lunch');
            const data = await response.json();
            let content = "";

            data.forEach(restaurant => {
                content += `<li class="glide__slide">
                                <h2>${restaurant.restaurant}</h2>`;
                if (restaurant.error) {
                    content += `<p>Error: ${restaurant.error}</p>`;
                } else {
                    restaurant.menu.forEach(day => {
                        content += `<h3>${day.date}</h3><ul>`;
                        if (day.menu) {
                            day.menu.forEach(item => {
                                content += `<li><strong>${item.dish}</strong> (${item.price}) - ${item.info}</li>`;
                            });
                        } else {
                            content += `<p>${day.message}</p>`;
                        }
                        content += `</ul>`;
                    });
                }
                content += `</li>`;
            });

            document.getElementById("menu").innerHTML = content;

            // ✅ Initialize both sliders AFTER content loads
            setTimeout(() => {
                new Glide('#menu-slider', {
                    type: 'carousel',
                    perView: 1,
                    autoplay: 10000, 
                    hoverpause: false,
                    animationDuration: 800,
                }).mount();

                new Glide('#web-slider', {
                    type: 'carousel',
                    perView: 1,
                    autoplay: 15000, // Rotate every 15 seconds
                    hoverpause: false,
                    animationDuration: 1000,
                }).mount();
            }, 100);
        }

        window.onload = fetchLunchData;
    </script>

    <style>
        iframe {
            width: 100%;
            height: 500px; /* Adjust as needed */
            border: none;
        }
    </style>

</body>
</html>
